## IPTV机顶盒FUZZ简述

   机顶盒在现在是挺常见的，但是在网上关于机顶盒测试漏洞的文章是少之又少，正好最近对机顶盒进行学习，现在总结了几个对机顶盒进行fuzz的方法！
  
 ` #PS：机顶盒进行一次PPPOE拨号，连接到电信的专用网络，盒子内置直播APP访问专网的指定地址实现节目观看。现在的连接方式我们不好抓包，最好是让观看的线路经过我们的电脑，这样抓包更直接有效。我的方法是将IPTV口的网线连接到电脑的网口，由电脑PPPOE拨号连接到电信的专网，再用电脑的无线网卡进行WIFI共享，IPTV盒子通过WIFI连接到电脑进行漏洞挖掘，这时候在电脑上运行抓包软件，就能获取相关源的连接地址.`

### FUZZ流程

```javascript
1.配置机顶盒连接到电视机显示器
2.电脑（攻击机器）需开启wifi共享
3.通过机顶盒的系统设置连接到电脑开启的wifi（机顶盒设置弱口令123456）
4.在电脑上面开启Wireshark或BURP等抓包软件
```

## FUZZ过程
1.在wireshark或burp抓包工具上面开启抓包后，使用遥控器控制连接机顶盒的电视机不断进行电视节目更换或相关操作
`这个过程和使用burp对放开Intercept收集web的页面等非常相似`

2.在wireshark抓包工具上面对操作过程的流量进行获取分析

<img src="http://upload.ouliu.net/i/20171115171008lwigc.png"  />

`PS：各地IPTV的实现型式都不一样，因些抓包分析也不一样。像江苏，四川，上海等地用的是组播 所以有的大佬抓出来的包没有rtsp协议，取而代之的都是rtp的协议`
<img src="http://upload.ouliu.net/i/20171115194947bwj6m.jpeg"  />


3.重点分析协议（IGMP、RTSP、HTTP）等
`这些流量要认真查看`

4.对流量内的请求地址进行分析比对后进行保存（留着最后FUZZ）

5.IGMP和RTSP协议存在但不限于泄露源播放地址、远程服务器等敏感信息泄露漏洞

<img src="http://upload.ouliu.net/i/2017111517085897w2o.jpeg"  />

6.HTTP协议存在但不限于WEB TOP10漏洞，深入即可对远程服务器进行攻击

<img src="http://upload.ouliu.net/i/20171115170656ryiki.png"  />

`这个我相信各位大佬不用小弟说都知道的`


